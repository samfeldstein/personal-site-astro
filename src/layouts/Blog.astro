---
// Layout
// Must be imported before stylesheet or base styles will take precedence
import DefaultPage from "./BaseLayout.astro";

// Components
import Tags from "../components/Tags.astro";

// Utils
// https://docs.astro.build/en/tutorials/add-content-collections/
import { getCollection } from "astro:content";
import { sortCollectionByDate } from "../scripts/utils";
import { getEntry } from "astro:content";

// Frontmatter
const { frontmatter } = Astro.props;

// Blog Collection
const posts = await getCollection("blog");
sortCollectionByDate(posts);

// Render lastest post
const entry = await getEntry("blog", posts[0].slug);
// const { Content } = await entry.render();
---

<DefaultPage
  title={frontmatter.title}
  description={frontmatter.description}
  underConstruction
>
  <section id="latest">
    <h2>Latest</h2>
    <a class="post-title" href={`/blog/${posts[0].slug}`}
      >{posts[0].data.title}</a
    >
    <Tags tags={posts[0].data.tags} />
    <!-- Render latest post content -->
    <!-- <Content /> -->
  </section>
  <section id="archive">
    <h2>Archive</h2>
    <ul class="postlist">
      {
        posts.map((post) => (
          <li class="postlist-item">
            <a class="post-title" href={`/blog/${post.slug}/`}>
              {post.data.title}
            </a>
            <Tags tags={post.data.tags} />
          </li>
        ))
      }
    </ul>
  </section>
</DefaultPage>

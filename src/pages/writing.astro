---
import BaseLayout from "../layouts/BaseLayout.astro";
import Date from "../components/Date.astro";
import Tags from "../components/Tags.astro";

import { getCollection } from "astro:content";
import { sortCollectionByDate } from "../scripts/utils.ts";
import { filterDrafts } from "../scripts/utils.ts";

const posts = await getCollection("blog", filterDrafts);
sortCollectionByDate(posts);

const writing = [
  {
    title: "Made of Memories",
    type: "Short Story",
    genre: "Horror",
    medium: "Podcast",
    date: "December 2023",
    outlet: "Tales to Terrify",
    url: "https://talestoterrify.com/episodes/619-z-j-garcia-samuel-feldstein/",
    blurb:
      "We are living until we are dying. We are dying until we are dead, and live again.",
  },
  {
    title: "Queen of the Thunderbeasts",
    type: "RPG",
    genre: "Fantasy",
    medium: "eBook (PDF)",
    date: "January 2023",
    outlet: "The Dungeon Masters Guild",
    url: "https://www.dmsguild.com/product/426630/Queen-of-the-Thunderbeasts?affiliate_id=1701028",
  },
  {
    title: "The First",
    type: "Short Story",
    genre: "Fantasy",
    medium: "Digital",
    date: "October 2022",
    outlet: "The Collidescope",
    url: "https://thecollidescope.com/2022/10/16/the-first/",
  },
  {
    title:
      "Big Bend Reproductive Coalition launches community needs assessment",
    type: "Article",
    medium: "Print, Digital",
    date: "August 2023",
    outlet: "The Big Bend Sentinel",
    url: "https://bigbendsentinel.com/2023/08/09/big-bend-reproductive-coalition-launches-community-needs-assessment-with-inaugural-town-hal/?mc_cid=b24b0bb606",
  },
  {
    title:
      "Trans-Pecos Festival of Music + Love doubles as platform for advocacy and outreach",
    type: "Article",
    medium: "Print, Digital",
    date: "October 2022",
    outlet: "The Big Bend Sentinel",
    url: "https://bigbendsentinel.com/2022/10/05/trans-pecos-festival-of-music-love-doubles-as-platform-for-advocacy-and-outreach/",
  },
  {
    title: "Absence of Meaning in 'The Lighthouse'",
    type: "Criticism",
    medium: "Digital",
    date: "April 2022",
    outlet: "The Frida Cinema Blog",
    url: "https://thefridacinema.org/film-criticism/absence-of-meaning-the-lighthouse/",
  },
];

// writing.sort((a, b) => new Date(b.date) - new Date(a.date));

// Structured Data
const schema = {
  "@context": "https://schema.org",
  "@type": "CreativeWork",
  name: "Writing Portfolio | Sam Feldstein",
  description:
    "My portfolio of fiction, short stories, poetry, essays, news articles, and informative video scripts.",
  url: "https://samfeldstein.xyz/writing/",
  image:
    "https://samfeldstein.xyz/images/sam-feldstein-open-graph-default.webp",
  author: {
    "@type": "Person",
    name: "Sam Feldstein",
    url: "https://samfeldstein.xyz",
  },
};
---

<BaseLayout title="Writing" schema={schema}>
  <h1>Writing I've Written</h1>
  <section class="published">
    {
      writing.map((item) => (
        <a href={item.url} class="entry">
          <div class="type date">
            <span class="gray">{item.type}</span>
            <span class="gray">{item.date}</span>
          </div>
          <h2 set:html={item.title.replace(/'(.*?)'/, "<em>$1</em>")} />

          <div class="gray outlet">
            <em>{item.outlet}</em>
          </div>
        </a>
      ))
    }
  </section>
  
  <p>
    <a href="/blog/tags/">Browse by category</a>. Subscribe via <a
      href="https://samfeldstein.xyz/feed.xml">RSS</a
    >. If you prefer to subscribe by email, you can use <a
      href="https://blogtrottr.com">Blogtrottr</a
    > to route the feed to your inbox.
  </p>

  <ul class="collection-list unstyled-list">
    {
      posts.map((post) => (
        <li class="flex-column">
          <Date date={post.data.pubDate} />
          <a
            href={`/blog/${post.id}/`}
            class="title collection-item-title"
          >
            {post.data.title}
          </a>
          <Tags tags={post.data.tags} path="blog" />
        </li>
      ))
    }
  </ul>
</BaseLayout>
